<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute the incidence of events — incidence • incidence2</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute the incidence of events — incidence" />
<meta property="og:description" content="Compute the incidence of events" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">incidence2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Using the incidence package</li>
    <li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/handling_incidence_objects.html">Handling incidence objects</a>
    </li>
    <li>
      <a href="../articles/customizing_incidence_plots.html">Customizing incidence plots</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/reconhub/incidence2">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute the incidence of events</h1>
    <small class="dont-index">Source: <a href='https://github.com/reconhub/incidence2/blob/master/R/incidence.R'><code>R/incidence.R</code></a></small>
    <div class="hidden name"><code>incidence.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the incidence of events</p>
    </div>

    <pre class="usage"><span class='fu'>incidence</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>date_index</span>,
  groups <span class='op'>=</span> <span class='cn'>NULL</span>,
  interval <span class='op'>=</span> <span class='fl'>1L</span>,
  first_date <span class='op'>=</span> <span class='cn'>NULL</span>,
  last_date <span class='op'>=</span> <span class='cn'>NULL</span>,
  na_as_group <span class='op'>=</span> <span class='cn'>TRUE</span>,
  standard <span class='op'>=</span> <span class='cn'>TRUE</span>,
  count <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A tibble or a data frame (see Note) representing a linelist.</p></td>
    </tr>
    <tr>
      <th>date_index</th>
      <td><p>The time index of the given data.  This should be the name,
with or without quotation, corresponding to a date column in x of the
class:  integer, numeric, Date, POSIXct, POSIXlt, and character. (See Note
about <code>numeric</code> and <code>character</code> formats)</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>An optional vector giving the names of the groups of
observations for which incidence should be grouped.  This can be given with
or without quotation.`</p></td>
    </tr>
    <tr>
      <th>interval</th>
      <td><p>An integer or character indicating the (fixed) size of the
time interval used for computing the incidence; defaults to 1 day. This can
also be a text string that corresponds to a valid date interval: day, week,
month, quarter, or year. (See Note).</p></td>
    </tr>
    <tr>
      <th>first_date, last_date</th>
      <td><p>optional first/last dates to be used. When
these are <code>NULL</code> (default), the dates from the first/last dates are taken
from the observations. If these dates are provided, the observations will
be trimmed to the range of [first_date, last_date].</p></td>
    </tr>
    <tr>
      <th>na_as_group</th>
      <td><p>A logical value indicating if missing group values (NA)
should treated as a separate category (<code>TRUE</code>) or removed from
consideration (<code>FALSE</code>).</p></td>
    </tr>
    <tr>
      <th>standard</th>
      <td><p>(Only applicable where date_index references a Date object)
When <code>TRUE</code> (default) and the <code>interval</code> one of "week", "month", "quarter",
or "year", then this will cause the bins for the counts to start at the
beginning of the interval (See Note).</p></td>
    </tr>
    <tr>
      <th>count</th>
      <td><p>The count variable of the given data.  If NULL (default) the
data is taken to be a linelist of individual observations.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An incidence2 object.  This is a subclass of tibble that represents
and aggregated count of observations grouped according to the specified
interval and, optionally, the given groups.  By default it will contain the
following columns:</p><ul>
<li><p><strong>bin_date</strong>:  The dates marking the left side of the bins used for
counting events. When <code>standard = TRUE</code> and the interval represents weeks,
months, quarters, or years, the first date will represent the first
standard date (See Interval specification, below).</p></li>
<li><p><strong>-groups-</strong>: If specified, column(s) containing the categories of the
given groups.</p></li>
<li><p><strong>count</strong>: The aggregated observation count.</p></li>
</ul>

<p>If a "week" interval is specified then the object may also contain
additional columns:</p><ul>
<li><p><strong>weeks</strong>: Dates in week format (YYYY-Www), where YYYY corresponds to the
year of the given week and ww represents the numeric week of the year.
This will be a produced from the function <code><a href='https://www.repidemicsconsortium.org/aweek/reference/date2week.html'>aweek::date2week()</a></code>. Note that
these will have a special <code>"week_start"</code> attribute indicating which day of
the ISO week the week starts on (see Weeks, below).</p></li>
</ul>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Input data (<code>dates</code>)</h3>

<ul>
<li><p><strong>Decimal (numeric) dates</strong>: will be truncated with a warning</p></li>
<li><p><strong>Character dates</strong> should be in the unambiguous <code>yyyy-mm-dd</code> (ISO 8601)
format. Any other format will trigger an error.</p></li>
</ul>


<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Interval specification (<code>interval</code>)</h3>
<p>If <code>interval</code> is a valid character (e.g. "week" or "1 month"), then
the bin will start at the beginning of the interval just before the first
observation by default. For example, if the first case was recorded on
Wednesday, 2018-05-09:</p><ul>
<li><p>"week"    : first day of the week (i.e. Monday, 2018-05-07) (defaults to
ISO weeks, see "Week intervals", below)</p></li>
<li><p>"month"   : first day of the month (i.e. 2018-05-01)</p></li>
<li><p>"quarter" : first day of the quarter (i.e. 2018-04-01)</p></li>
<li><p>"year"    : first day of the calendar year (i.e. 2018-01-01)</p></li>
</ul>

<p>These default intervals can be overridden with <code>standard = FALSE</code>, which
sets the interval to begin at the first observed case.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Week intervals</h3>


<p>It is possible to construct standardized
incidence objects standardized to any day of the week thanks to the
<code><a href='https://www.repidemicsconsortium.org/aweek/reference/date2week.html'>aweek::date2week()</a></code> function from the <span class="pkg">aweek</span> package. The default
state is to use ISO 8601 definition of weeks, which start on Monday. You can
specify the day of the week an incidence object should be standardised to by
using the pattern "n W weeks" where "W" represents the weekday in an
English or current locale and "n" represents the duration, but this can be
ommitted.  Below are examples of specifying weeks starting on different days
assuming we had data that started on 2016-09-05, which is ISO week 36 of
2016:</p><ul>
<li><p>interval = "2 monday weeks" (Monday 2016-09-05)</p></li>
<li><p>interval = "1 tue week" (Tuesday 2016-08-30)</p></li>
<li><p>interval = "1 Wed week" (Wednesday 2016-08-31)</p></li>
<li><p>interval = "1 Thursday week" (Thursday 2016-09-01)</p></li>
<li><p>interval = "1 F week" (Friday 2016-09-02)</p></li>
<li><p>interval = "1 Saturday week" (Saturday 2016-09-03)</p></li>
<li><p>interval = "Sunday week" (Sunday 2016-09-04)</p></li>
</ul>

<p>It's also possible to use something like "3 weeks: Saturday"; In addition,
there are keywords reserved for specific days of the week:</p><ul>
<li><p>interval = "week", standard = TRUE (Default, Monday)</p></li>
<li><p>interval = "ISOweek"  (Monday)</p></li>
<li><p>interval = "EPIweek"  (Sunday)</p></li>
<li><p>interval = "MMWRweek" (Sunday)</p></li>
</ul>

<p>The "EPIweek" specification is not strictly reserved for CDC epiweeks, but
can be prefixed (or posfixed) by a day of the week: "1 epiweek: Saturday".</p>

<p>The intervals for "month", "quarter", and "year" will necessarily vary in the
number of days they encompass and warnings will be generated when the first
date falls outside of a calendar date that is easily represented across the
interval.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"outbreaks"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/source.html'>withAutoprint</a></span><span class='op'>(</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>ebola_sim_clean</span>, package <span class='op'>=</span> <span class='st'>"outbreaks"</span><span class='op'>)</span>
    <span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>ebola_sim_clean</span><span class='op'>$</span><span class='va'>linelist</span>


    <span class='co'># daily incidence</span>
    <span class='va'>dat</span> <span class='op'>%&gt;%</span>
      <span class='fu'>incidence</span><span class='op'>(</span><span class='va'>date_of_onset</span><span class='op'>)</span>

    <span class='co'># weekly incidence</span>
    <span class='va'>dat</span> <span class='op'>%&gt;%</span>
      <span class='fu'>incidence</span><span class='op'>(</span><span class='va'>date_of_onset</span>, interval <span class='op'>=</span> <span class='st'>"week"</span>, standard <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

    <span class='co'># starting on a Monday</span>
    <span class='va'>dat</span> <span class='op'>%&gt;%</span>
      <span class='fu'>incidence</span><span class='op'>(</span><span class='va'>date_of_onset</span>, interval <span class='op'>=</span> <span class='st'>"isoweek"</span><span class='op'>)</span>

    <span class='co'># starting on a Sunday</span>
    <span class='va'>dat</span> <span class='op'>%&gt;%</span>
      <span class='fu'>incidence</span><span class='op'>(</span><span class='va'>date_of_onset</span>, interval <span class='op'>=</span> <span class='st'>"epiweek"</span><span class='op'>)</span>

    <span class='co'># starting on a Saturday</span>
    <span class='va'>dat</span> <span class='op'>%&gt;%</span>
      <span class='fu'>incidence</span><span class='op'>(</span><span class='va'>date_of_onset</span>, interval <span class='op'>=</span> <span class='st'>"saturday epiweek"</span><span class='op'>)</span>

    <span class='co'># group by gender</span>
    <span class='va'>dat</span> <span class='op'>%&gt;%</span>
      <span class='fu'>incidence</span><span class='op'>(</span><span class='va'>date_of_onset</span>, interval <span class='op'>=</span> <span class='fl'>7</span>, groups <span class='op'>=</span> <span class='va'>gender</span><span class='op'>)</span>

    <span class='co'># group by gender and hospital</span>
    <span class='va'>dat</span> <span class='op'>%&gt;%</span>
      <span class='fu'>incidence</span><span class='op'>(</span><span class='va'>date_of_onset</span>,
                interval <span class='op'>=</span> <span class='st'>"2 weeks"</span>,
                groups <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>gender</span>, <span class='va'>hospital</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; &gt; data(ebola_sim_clean, package = "outbreaks")
#&gt; &gt; dat &lt;- ebola_sim_clean$linelist
#&gt; &gt; dat %&gt;% incidence(date_of_onset)
#&gt; &gt; dat %&gt;% incidence(date_of_onset, interval = "week", standard = FALSE)
#&gt; &gt; dat %&gt;% incidence(date_of_onset, interval = "isoweek")
#&gt; &gt; dat %&gt;% incidence(date_of_onset, interval = "epiweek")
#&gt; &gt; dat %&gt;% incidence(date_of_onset, interval = "saturday epiweek")
#&gt; &gt; dat %&gt;% incidence(date_of_onset, interval = 7, groups = gender)
#&gt; &gt; dat %&gt;% incidence(date_of_onset, interval = "2 weeks", groups = c(gender, 
#&gt; +     hospital))</div><div class='input'>
<span class='co'># use of first_date</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>dates <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.Date</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>10</span>, <span class='fl'>10</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>%&gt;%</span> <span class='fu'>incidence</span><span class='op'>(</span><span class='va'>dates</span>,
                  interval <span class='op'>=</span> <span class='st'>"week"</span>,
                  first_date <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.Date</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>1 observations outside of [2021-02-10, 2021-02-18] were removed.</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tim Taylor, Thibaut Jombart, Zhian N. Kamvar, Rich FitzJohn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


